#import ivpqindex
from pathlib import Path
import os
import random
import json
from datasets import Dataset, load_dataset

def file_loader(data_path):
    for version in os.listdir(data_path):
        for contract in os.listdir(data_path / version):
            rf = open(str(data_path / version / contract))
            yield json.load(rf)

part = ["f3ffif43iof3oifif4f3f43oif4iof4if4oi4ff3ff44f4f" for i in range(0, 500000)]

def batcher(iterable, n=1):
    l = len(iterable)
    for ndx in range(0, l, n):
        yield iterable[ndx:min(ndx + n, l)]

train_dir = Path("C:\\Documents\\Dawn Song Lab\\Dataset\\normal-unoptimize_15000\\json_train_dataset")
train_data = [file for file in file_loader(train_dir)]
for batch in batcher(train_data, 4):
    for contract_pair in batch:
        print(contract_pair)
    print('----------------------')

'''train_dir = Path("C:\\Documents\\Dawn Song Lab\\Dataset\\normal-unoptimize_15000\\json_train_dataset")
val_dir = Path("C:\\Documents\\Dawn Song Lab\\Dataset\\normal-unoptimize_15000\\json_val_dataset")
data_files = {'train':str(train_dir), 'val':str(val_dir)}
train_data = load_dataset('json', data_files=data_files, split='train', streaming=True)
train_data.shuffle(seed=42, buffer_size=10_000)
val_dataset = load_dataset('json', data_files=data_files, split='val', streaming=True)
val_dataset.shuffle(seed=42, buffer_size=10_000)'''




